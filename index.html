<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>SeeBee ‚Ä¢ Meliponicultura</title>

    <link rel="manifest" href="./manifest.webmanifest" />
    <meta name="theme-color" content="#071a12" />

    <link rel="stylesheet" href="./css/style.css" />

    <!-- Leaflet -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
  </head>

  <body>
    <!-- TOPBAR (s√≥ aparece logado via JS) -->
    <header id="topbar" class="topbar topbar--hidden">
      <div class="brand">
        <div class="brand__icon">üêù</div>
        <div class="brand__text">
          <div class="brand__title">SeeBee</div>
          <div class="brand__subtitle">Meliponicultura</div>
        </div>
      </div>

      <div class="topbar__right">
        <!-- indicador online/offline (s√≥ logado) -->
        <div id="netBadge" class="net net--offline" title="Status de conex√£o">
          <span class="net__dot"></span>
          <span class="net__text">Offline</span>
        </div>

        <!-- hamburger -->
        <button id="btnMenu" class="iconBtn" aria-label="Menu">
          ‚ò∞
        </button>
      </div>
    </header>

    <!-- DRAWER / MENU -->
    <aside id="drawer" class="drawer drawer--hidden">
      <div class="drawer__panel">
        <div class="drawer__header">
          <div class="drawer__title">Menu</div>
          <button id="btnCloseMenu" class="iconBtn" aria-label="Fechar">‚úï</button>
        </div>

        <div class="drawer__user">
          <div class="drawer__userLabel">Usu√°rio</div>
          <div id="userEmail" class="drawer__userEmail"></div>
        </div>

        <nav class="drawer__nav">
          <button id="navHome" class="navItem navItem--active">Trilhas</button>
          <button id="navInstalacoes" class="navItem">Meus ninhos</button>
          <button id="navProfile" class="navItem">Meus dados</button>

        </nav>

        <div class="drawer__footer">
          <button id="btnLogout" class="btn btn--secondary w100">Sair</button>
        </div>
      </div>
      <div id="drawerBackdrop" class="drawer__backdrop"></div>
    </aside>

    <main class="page">
      <!-- AUTH -->
      <section id="authCard" class="card authCard">
        <div class="authBrand">
          <div class="authBrand__icon">üêù</div>
          <div class="authBrand__title">SeeBee</div>
          <div class="authBrand__subtitle">Meliponicultura</div>
        </div>

        <h1 class="h1">Entrar</h1>
        <p class="muted">Use seu e-mail e senha (Supabase Auth) ou Google.</p>

        <div class="field">
          <label for="email">E-mail</label>
          <input id="email" type="email" placeholder="seuemail@..." autocomplete="email" />
        </div>

        <div class="field">
          <label for="password">Senha</label>
          <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" />
        </div>

        <div class="row row--gap">
          <button id="btnLogin" class="btn btn--primary">Entrar</button>
          <button id="btnSignup" class="btn btn--secondary">Criar conta</button>
        </div>

        <div class="divider"></div>

        <button id="btnGoogle" class="btn btn--google w100">Entrar com Google</button>

        <div id="authMsg" class="msg msg--hidden"></div>
      </section>

      <!-- APP VIEWS -->
      <section id="app" class="app app--hidden">
        <!-- VIEW: HOME / TRAJETO -->
        <section id="viewHome" class="view view--active">
          <section class="grid">
            <div class="col col--left">
              <section class="card">
                <h2 class="h2">Trajeto</h2>
                <p class="muted">Inicie o trajeto e depois marque ninhos com observa√ß√£o e foto.</p>

                <div class="row row--gap">
                  <button id="btnStartRoute" class="btn btn--primary">Iniciar trajeto</button>
                  <button id="btnFinishRoute" class="btn btn--secondary" disabled>Finalizar trajeto</button>
                </div>

                <div class="stats">
                  <div class="stat">
                    <div class="stat__label">Dist√¢ncia</div>
                    <div id="distance" class="stat__value">0 m</div>
                  </div>

                  <div class="stat">
                    <div class="stat__label">Ninhos</div>
                    <div id="nestCount" class="stat__value">0</div>
                  </div>
                </div>

                <div id="routeHint" class="hint">
                  Ao iniciar, o mapa acompanha sua caminhada e desenha a linha em tempo real.
                </div>
              </section>

              <section class="card">
                <h2 class="h2">Marcar ninho</h2>

                <div class="field">
                  <label for="note">Observa√ß√£o</label>
                  <input id="note" type="text" placeholder="Ex.: entrada ativa, √°rvore X, sombra, sinais..." />
                </div>

                <div class="field">
                  <label for="status">Status</label>
                  <select id="status">
                    <option value="CATALOGADO" selected>CATALOGADO</option>
                    <option value="CAPTURADO">CAPTURADO</option>
                  </select>
                </div>

                <div class="field">
                  <label for="species">Esp√©cie (opcional)</label>
                  <input id="species" type="text" placeholder="Ex.: Jata√≠, Uru√ßu, Manda√ßaia‚Ä¶ ou N√£o identifiquei" />
                </div>

                <div class="field">
                  <label for="photo">Foto (opcional)</label>
                  <input id="photo" type="file" accept="image/*" />
                  <div id="photoName" class="muted small"></div>
                </div>

                <button id="btnMarkNest" class="btn btn--primary">Marcar ninho</button>

                <div id="nestMsg" class="msg msg--hidden"></div>
              </section>

              <section class="card">
                <h2 class="h2">Registros desta trilha</h2>
                <p class="muted">Os ninhos marcados aparecem aqui para confer√™ncia r√°pida.</p>
                <div id="nestList" class="nestList"></div>
              </section>
            </div>

            <div class="col col--right">
              <section class="card mapCard">
                <div id="map" class="map"></div>
              </section>
            </div>
          </section>
        </section>

        <!-- VIEW: INSTALA√á√ïES -->
        <section id="viewInstalacoes" class="view">
          <section class="grid">
            <div class="col col--left">
              <section class="card">
                <h2 class="h2">Minhas instala√ß√µes</h2>
                <p class="muted">
                  Aqui ficam seus trajetos gravados. Clique para abrir, ver rota + ninhos e atualizar para ‚ÄúCAPTURADO‚Äù.
                </p>

                <div id="routesMsg" class="msg msg--hidden"></div>
                <div id="routesList" class="list"></div>
              </section>

              <section class="card">
                <h2 class="h2">Ninhos do trajeto selecionado</h2>
                <p class="muted">Voc√™ pode alterar o status para CAPTURADO (sem perder a data do CATALOGADO).</p>

                <div id="routeDetailTitle" class="muted"></div>
                <div id="routeNestsMsg" class="msg msg--hidden"></div>
                <div id="routeNestsList" class="list"></div>
              </section>
            </div>

            <div class="col col--right">
              <section class="card mapCard">
                <div id="map2" class="map"></div>
              </section>
            </div>
          </section>
        </section>

        <!-- VIEW: PERFIL -->
        <section id="viewProfile" class="view">
          <section class="card profileCard">
            <h2 class="h2">Meus dados</h2>
            <p class="muted">Vamos come√ßar pelo essencial e evoluir depois (modo claro/escuro vir√° aqui tamb√©m).</p>

            <div class="field">
              <label>E-mail</label>
              <input id="profileEmail" type="text" disabled />
            </div>

            <div class="field">
              <label for="userType">Voc√™ √©:</label>
              <select id="userType">
                <option value="">Selecione‚Ä¶</option>
                <option value="enthusiasta">Entusiasta</option>
                <option value="meliponicultor">Meliponicultor</option>
                <option value="pesquisador">Pesquisador</option>
              </select>
            </div>

            <button id="btnSaveProfile" class="btn btn--primary">Salvar</button>
            <div id="profileMsg" class="msg msg--hidden"></div>
          </section>
        </section>
      </section>
    </main>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Leaflet -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
