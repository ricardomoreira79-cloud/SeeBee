<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SeeBee ‚Äî Rastreador de ninhos</title>

    <link rel="manifest" href="./manifest.webmanifest" />
    <meta name="theme-color" content="#0b1220" />

    <link rel="stylesheet" href="./css/style.css" />

    <!-- Leaflet -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
  </head>

  <body>
    <header class="topbar">
      <div class="topbar__left">
        <div class="brand">
          <div class="brand__logo">üêù</div>
          <div class="brand__text">
            <div class="brand__title">SeeBee</div>
            <div class="brand__subtitle">Rastreador de ninhos</div>
          </div>
        </div>
      </div>

      <div class="topbar__right">
        <div id="userEmail" class="userEmail">‚Äî</div>
        <button id="btnLogout" class="btn btn--ghost">Sair</button>
      </div>
    </header>

    <main class="layout">
      <!-- AUTH -->
      <section id="authPanel" class="authPanel hidden">
        <div class="card authCard">
          <h1>Entrar</h1>
          <p class="muted">
            Use seu e-mail e senha do Supabase Auth.
          </p>

          <label class="field">
            <span>E-mail</span>
            <input id="email" type="email" placeholder="seuemail@dominio.com" autocomplete="email" />
          </label>

          <label class="field">
            <span>Senha</span>
            <input id="password" type="password" placeholder="********" autocomplete="current-password" />
          </label>

          <div class="row">
            <button id="btnLogin" class="btn btn--primary">Entrar</button>
            <button id="btnSignup" class="btn btn--secondary">Criar conta</button>
          </div>

          <div id="authMsg" class="msg"></div>
        </div>
      </section>

      <!-- APP -->
      <section id="appPanel" class="appPanel">
        <div class="grid">
          <aside class="leftCol">
            <!-- TRAJETO -->
            <div class="card">
              <h2>Trajeto</h2>
              <p class="muted">
                Inicie o trajeto e depois marque ninhos com observa√ß√£o e foto.
              </p>

              <div class="row">
                <button id="btnStartRoute" class="btn btn--primary">Iniciar trajeto</button>
                <button id="btnFinishRoute" class="btn btn--ghost" disabled>Finalizar trajeto</button>
              </div>

              <div class="stats">
                <div class="stat">
                  <div class="stat__label">Dist√¢ncia</div>
                  <div id="distance" class="stat__value">0 m</div>
                </div>
                <div class="stat">
                  <div class="stat__label">√öltima posi√ß√£o</div>
                  <div id="lastPos" class="stat__value">‚Äî</div>
                </div>
                <div class="stat">
                  <div class="stat__label">Ninhos no trajeto</div>
                  <div id="routeNestsCount" class="stat__value">0</div>
                </div>
              </div>

              <div id="routeMsg" class="msg"></div>
            </div>

            <!-- MARCAR NINHO -->
            <div class="card">
              <h2>Marcar ninho</h2>

              <label class="field">
                <span>Observa√ß√£o</span>
                <input id="nestNotes" type="text" placeholder="Ex.: entrada ativa, √°rvore X, sombra, sinais..." />
              </label>

              <label class="field">
                <span>Status</span>
                <select id="nestStatus">
                  <option value="PLANNED">PLANNED</option>
                  <option value="DEPLOYED" selected>DEPLOYED</option>
                  <option value="OCCUPIED">OCCUPIED</option>
                  <option value="REMOVED">REMOVED</option>
                  <option value="REDEPLOYED">REDEPLOYED</option>
                  <option value="FAILED">FAILED</option>
                  <option value="UNKNOWN">UNKNOWN</option>
                </select>
              </label>

              <label class="field">
                <span>Foto (opcional)</span>
                <input id="nestPhoto" type="file" accept="image/*" capture="environment" />
                <small class="muted">
                  A foto √© enviada para o Storage em <code>ninhos-fotos/&lt;seu_user_id&gt;/...</code>
                </small>
              </label>

              <button id="btnMarkNest" class="btn btn--primary">Marcar ninho</button>

              <div id="nestMsg" class="msg"></div>
            </div>

            <!-- LISTA -->
            <div class="card">
              <div class="row row--space">
                <h2>Ninhos</h2>
                <button id="btnRefresh" class="btn btn--ghost">Atualizar</button>
              </div>
              <div id="nestsList" class="list"></div>
            </div>
          </aside>

          <section class="mapCol">
            <div class="mapWrap card">
              <div id="map" class="map"></div>
              <div class="mapHint">
                Clique no mapa para ajustar a posi√ß√£o do pr√≥ximo ninho.
              </div>
            </div>
          </section>
        </div>
      </section>
    </main>

    <!-- Leaflet -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
