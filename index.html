<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>SeeBee App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <link rel="stylesheet" href="./css/main.css">
</head>
<body>

  <div id="auth-screen">
    <div class="brand-hero"><div class="brand-logo">ğŸ</div><div class="brand-name">SeeBee</div></div>
    <div id="auth-card">
      <h2>Entrar</h2>
      <div class="auth-field"><label>E-mail</label><input id="email" type="email"></div>
      <div class="auth-field"><label>Senha</label><input id="password" type="password"></div>
      <button id="btnLogin" class="btn-primary">Entrar</button>
    </div>
  </div>

  <div id="app-screen" class="hidden">
    
    <div id="side-menu" class="side-drawer">
      <div class="drawer-header">
        <div class="profile-mini">
          <div class="avatar-circle">A</div>
          <div style="margin-left:10px;">
             <span id="menu-name-display" style="font-weight:bold;">UsuÃ¡rio</span>
             <span style="font-size:12px; display:block; color:#10b981;">ADMINISTRADOR</span>
          </div>
        </div>
        <button id="close-menu">âœ•</button>
      </div>
      <nav class="drawer-nav">
        <button class="menu-item" onclick="app.nav('view-home')">ğŸ  InÃ­cio</button>
        <button class="menu-item" onclick="app.nav('view-traps')">ğŸ—ºï¸ Instalar Ninhos</button>
        <button class="menu-item" onclick="app.nav('view-profile')">ğŸ‘¤ Perfil</button>
        <hr><button id="btnLogout" class="menu-item danger">Sair</button>
      </nav>
    </div>

    <header class="app-header">
      <button id="open-menu" class="btn-icon">â˜°</button>
      <div class="brand-mini">SeeBee</div>
      <div style="width:24px;"></div>
    </header>

    <main class="content-area">
      <section id="view-home" class="view-section active">
        <div class="dashboard-grid">
          <div class="dash-card" onclick="app.nav('view-traps')">
            <div class="dash-icon">ğŸ—ºï¸</div><h3>Nova InstalaÃ§Ã£o</h3>
          </div>
          <div class="dash-card" onclick="app.nav('view-profile')">
            <div class="dash-icon">ğŸ‘¤</div><h3>Perfil</h3>
          </div>
        </div>
      </section>

      <section id="view-traps" class="view-section hidden">
        <div class="tracking-card">
          <div class="card-header"><h3>InstalaÃ§Ã£o</h3><span id="statusBadge" class="badge-status">Parado</span></div>
          <div class="action-buttons-row">
            <button id="btnStart" class="btn-action-start" onclick="app.startRecording()">â–¶ Iniciar</button>
            <button id="btnStop" class="btn-action-stop hidden" onclick="app.stopRecording()">â–  Parar</button>
            <button id="btnNest" class="btn-action-nest" onclick="app.openNestModal()" disabled>+ Ninho</button>
          </div>
          <div class="stats-row">
            <div class="stat-pill">Dist: <b id="distText">0 m</b></div>
            <div class="stat-pill">Ninhos: <b id="nestCountText">0</b></div>
            <div class="stat-pill" id="gpsStatus">GPS OFF</div>
          </div>
        </div>
        <div id="map"></div>
      </section>

      <section id="view-profile" class="view-section hidden">
        <h3>Meu Perfil</h3>
        <div class="card-profile-settings">
            <label class="field-label">Nome Completo</label>
            <input type="text" id="profName" class="input-dark">
            <label class="field-label">Telefone</label>
            <input type="text" id="profPhone" class="input-dark">
            <button class="btn-primary" onclick="app.saveProfile()">Salvar Dados</button>
        </div>
      </section>
    </main>

    <div id="nest-modal" class="modal-backdrop" style="display:none">
      <div class="modal-card">
        <h3>Registrar Ninho</h3>
        <textarea id="nestNote" rows="3" placeholder="ObservaÃ§Ãµes..."></textarea>
        <label class="btn-outline-photo" id="lblPhoto" style="margin-top:10px;">
            ğŸ“· Foto <input id="nestPhoto" type="file" accept="image/*" style="display:none">
        </label>
        <div class="modal-actions" style="margin-top:20px;">
            <button class="btn-ghost" onclick="document.getElementById('nest-modal').style.display='none'">Cancelar</button>
            <button class="btn-solid" onclick="app.confirmNest()">Salvar</button>
        </div>
      </div>
    </div>

    <div id="routeHint" class="hint-toast hidden"></div>
  </div>

  <script src="./js/app.js"></script>
</body>
</html>