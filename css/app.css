:root{
  --green-dark:#14532d;
  --green:#16a34a;
  --bg:#020617;
  --border:#1f2937;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --warn:#f97316;
  --danger:#b91c1c;
  --radius:14px;
  --shadow:0 16px 40px rgba(0,0,0,.75);
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background: radial-gradient(circle at top, #022c22 0, #020617 45%, #000 100%);
  color:var(--text);
}
.hidden{display:none!important}
button,input,textarea{font-family:inherit}

a{color:inherit;text-decoration:none}

/* ====== APP SHELL ====== */
.shell{
  max-width:1200px;
  margin:0 auto;
  padding:14px;
}

/* Topbar estilo "menu + centralizado" */
.topbar{
  position:sticky;
  top:0;
  z-index:50;
  backdrop-filter: blur(10px);
  background: rgba(2,6,23,.72);
  border:1px solid rgba(31,41,55,.7);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:10px 12px;
  display:grid;
  grid-template-columns: 44px 1fr 44px;
  align-items:center;
  gap:8px;
  margin-bottom:12px;
}

.icon-btn{
  width:40px;height:40px;
  border-radius:12px;
  border:1px solid rgba(75,85,99,.7);
  background: rgba(2,6,23,.6);
  color: var(--text);
  cursor:pointer;
}
.icon-btn:hover{border-color:rgba(156,163,175,.9)}

.brand-center{
  display:flex;
  flex-direction:column;
  align-items:center;
  line-height:1.05;
}
.brand-title{
  font-size:1.05rem;
  font-weight:700;
  letter-spacing:.06em;
}
.brand-sub{
  font-size:.72rem;
  color:var(--muted);
}

.brand-bee{
  width:40px;height:40px;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:20px;
  background: radial-gradient(circle at 30% 20%, #facc15 0, #ea580c 45%, #7c2d12 100%);
  box-shadow: 0 12px 26px rgba(0,0,0,.75);
}

/* Status online/offline (topo) */
.netbar{
  margin:10px 0 12px;
  display:flex;
  justify-content:center;
}
.status-pill{
  font-size:.82rem;
  padding:6px 12px;
  border-radius:999px;
  border:1px solid rgba(21,128,61,.55);
  background:#064e3b;
  color:#bbf7d0;
  display:inline-flex;
  align-items:center;
  gap:8px;
}
.status-pill.offline{
  border-color: rgba(185,28,28,.55);
  background:#450a0a;
  color:#fecaca;
}
.dot{
  width:8px;height:8px;border-radius:999px;
  background:#22c55e;
  box-shadow:0 0 0 4px rgba(34,197,94,.18);
}
.status-pill.offline .dot{
  background: var(--warn);
  box-shadow:0 0 0 4px rgba(249,115,22,.18);
}

/* ====== CARDS ====== */
.grid{
  display:grid;
  grid-template-columns: minmax(260px, 330px) minmax(0,1fr);
  gap:12px;
}
.card{
  background: radial-gradient(circle at top left, #065f4633, #020617 60%, #000 100%);
  border-radius: var(--radius);
  border:1px solid var(--border);
  padding:14px;
  box-shadow: var(--shadow);
}
.card h3{
  margin:0 0 8px;
  font-size:1rem;
  display:flex;
  align-items:center;
  gap:8px;
}
.subtitle{
  margin:0 0 12px;
  font-size:.85rem;
  color:var(--muted);
}

/* Controls */
.controls{
  display:grid;
  grid-template-columns: 1.3fr 1fr;
  gap:8px;
  margin-bottom:10px;
}
.btn{
  width:100%;
  border:none;
  border-radius:999px;
  padding:10px 12px;
  font-weight:700;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn-start{background:linear-gradient(135deg,#16a34a,#22c55e); color:#022c22}
.btn-stop{background:linear-gradient(135deg,#b91c1c,#f97316); color:#fff7ed}
.btn-secondary{
  background: rgba(2,6,23,.65);
  color: var(--text);
  border: 1px solid rgba(75,85,99,.75);
}
.badge{
  font-size:.72rem;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(20,83,45,.8);
  background:#022c22;
  color:#bbf7d0;
}

.info-row{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  font-size:.8rem;
  color:var(--muted);
  padding-top:8px;
  border-top:1px dashed rgba(31,41,55,.85);
}
.pill{
  padding:3px 10px;
  border-radius:999px;
  background: rgba(2,6,23,.65);
  border:1px solid rgba(31,41,55,.9);
}

/* Map */
#map{
  width:100%;
  height:340px;
  border-radius: var(--radius);
  overflow:hidden;
}
.leaflet-container{background: #020617}

/* Routes list */
.routes{
  margin-top:14px;
  margin-bottom:30px;
}
.routes-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  margin:10px 0 6px;
}
.routes-head h3{margin:0;font-size:.98rem}
.route-empty{
  font-size:.85rem;
  color:var(--muted);
  padding:12px;
  border-radius:12px;
  border:1px dashed rgba(31,41,55,.9);
  background: rgba(2,6,23,.45);
}
.route-card{
  margin-top:8px;
  border-radius:12px;
  border:1px solid rgba(31,41,55,.9);
  background: rgba(2,6,23,.85);
  padding:10px;
  display:grid;
  grid-template-columns: 1fr auto;
  gap:10px;
}
.route-title{font-weight:800; margin-bottom:2px}
.route-meta{font-size:.78rem;color:var(--muted)}
.route-actions{display:flex; flex-wrap:wrap; gap:6px; justify-content:flex-end}
.btn-xs{
  border-radius:999px;
  border:1px solid rgba(75,85,99,.75);
  background: rgba(2,6,23,.65);
  color: var(--text);
  padding:6px 10px;
  font-size:.78rem;
  cursor:pointer;
}
.btn-xs.danger{border-color:rgba(127,29,29,.9); color:#fecaca}
.sync-warn{color:#facc15}

/* Thumbs */
.thumbs{display:flex; gap:6px; flex-wrap:wrap; margin-top:6px}
.thumb{
  width:44px;height:44px; object-fit:cover;
  border-radius:8px;
  border:1px solid rgba(31,41,55,.9);
  cursor:pointer;
}

/* Drawer */
.drawer-backdrop{
  position:fixed; inset:0;
  background: rgba(0,0,0,.65);
  display:none;
  z-index:1000;
}
.drawer{
  position:fixed;
  top:10px; left:10px; bottom:10px;
  width:min(320px, 86vw);
  border-radius: 18px;
  border:1px solid rgba(31,41,55,.9);
  background: rgba(2,6,23,.92);
  box-shadow: 0 24px 60px rgba(0,0,0,.85);
  padding:12px;
  transform: translateX(-110%);
  transition: transform .22s ease;
}
.drawer-backdrop.open{display:block}
.drawer-backdrop.open .drawer{transform: translateX(0)}
.drawer-head{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; margin-bottom:10px;
}
.drawer-user{
  font-size:.82rem;
  color:var(--muted);
}
.drawer-menu{
  display:flex; flex-direction:column; gap:8px; margin-top:10px;
}
.menu-item{
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(31,41,55,.9);
  background: rgba(2,6,23,.55);
  cursor:pointer;
}
.menu-item:hover{border-color:rgba(156,163,175,.85)}
.menu-title{font-weight:800; margin-bottom:3px}
.menu-sub{font-size:.78rem; color:var(--muted)}

/* Modals */
.modal-backdrop{
  position:fixed; inset:0;
  background: rgba(0,0,0,.82);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1100;
  padding:16px;
}
.modal{
  width:100%;
  max-width:400px;
  background: rgba(2,6,23,.96);
  border-radius: 18px;
  border:1px solid rgba(31,41,55,.95);
  box-shadow: 0 24px 60px rgba(0,0,0,.9);
  padding:16px;
}
.modal h4{margin:0 0 6px}
.modal p{margin:0 0 12px; color:var(--muted); font-size:.88rem}
.field{margin-bottom:10px}
.field label{display:block; margin-bottom:6px; color:var(--muted); font-size:.82rem}
.field textarea{
  width:100%;
  min-height:88px;
  border-radius:12px;
  border:1px solid rgba(75,85,99,.85);
  background: rgba(2,6,23,.6);
  color: var(--text);
  padding:10px;
  font-size:.95rem;
  box-shadow: inset 0 0 0 1px rgba(17,24,39,.9), 0 10px 26px rgba(0,0,0,.55);
  outline:none;
}
.file-pill{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border-radius:999px;
  border:1px dashed rgba(156,163,175,.7);
  cursor:pointer;
}
.file-pill:hover{border-style:solid}
.file-pill input{display:none}
.file-name{display:block; margin-top:6px; color:var(--muted); font-size:.8rem}
.modal-actions{
  display:flex; justify-content:flex-end; gap:8px; margin-top:6px;
}
.btn-sm{
  border-radius:999px;
  border:1px solid rgba(75,85,99,.75);
  background: rgba(2,6,23,.65);
  color: var(--text);
  padding:8px 12px;
  font-size:.82rem;
  cursor:pointer;
}
.btn-sm.primary{
  border-color: rgba(21,128,61,.85);
  background: linear-gradient(135deg,#16a34a,#22c55e);
  color:#022c22;
  font-weight:900;
}

/* Photo modal */
.photo-modal{
  position:fixed; inset:0;
  background: rgba(0,0,0,.88);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1200;
  padding:16px;
}
.photo-modal img{
  max-width:100%;
  max-height:100%;
  border-radius:14px;
  box-shadow: 0 28px 70px rgba(0,0,0,.95);
}
.photo-close{
  position:fixed; top:16px; right:16px;
  border-radius:999px;
  border:1px solid rgba(75,85,99,.85);
  background: rgba(2,6,23,.75);
  color: var(--text);
  padding:8px 12px;
  cursor:pointer;
}

/* Toast */
.toast{
  position:fixed;
  left:50%;
  bottom:16px;
  transform:translateX(-50%);
  background: rgba(2,6,23,.9);
  border:1px solid rgba(31,41,55,.9);
  padding:10px 12px;
  border-radius:999px;
  box-shadow: 0 18px 40px rgba(0,0,0,.8);
  font-size:.85rem;
  display:none;
  z-index:1300;
}
.toast.show{display:block}

/* Mobile */
@media (max-width: 900px){
  .grid{grid-template-columns:1fr}
  #map{height:280px}
}